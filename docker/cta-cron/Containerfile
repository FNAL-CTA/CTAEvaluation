FROM gitlab-registry.cern.ch/linuxsupport/cc7-base

RUN yum upgrade -y \
    && yum clean all \
    && rm -rf /var/cache/yum

# Convenience stuff. Remove in production?
RUN yum install -y git curl which nano wget jq sudo \
    && yum clean all \
    && rm -rf /var/cache/yum

ADD cta-public-5-centos7.repo  /etc/yum.repos.d/
ADD oracle.repo  /etc/yum.repos.d/
ADD postgres.repo  /etc/yum.repos.d/

RUN yum -y install python3 cta-cli cta-catalogueutils unzip postgresql12 \
    && yum clean all \
    && rm -rf /var/cache/yum

ADD entrypoint.sh /

ENTRYPOINT ["/entrypoint.sh"]
